# OfferHub 项目详细介绍

## 一、项目概述

OfferHub 是一款面向求职者的智能面试辅助平台，提供实时面试指导、AI 建议生成、面试记录分析、错题本管理、知识库学习等功能。项目采用前后端分离架构，包含 Electron 桌面端（V2）和 Web 浏览器端两套前端应用，共享同一套后端服务。

### 1.1 核心功能

- **实时面试辅助**：支持语音转文字、AI 实时建议、屏幕录制与监控
- **模拟面试**：提供多种面试模式（普通、压力、行为、技术、综合）
- **面试总结**：自动生成面试报告，包含能力分析图表和改进建议
- **错题本管理**：记录面试中的薄弱环节，支持分类复习和导出
- **知识库学习**：提供面试题库、参考答案和学习资料
- **计费系统**：支持时长购买、套餐选择、订单管理
- **多语言支持**：中英文界面切换
- **用户中心**：个人信息管理、使用统计、设置偏好

### 1.2 技术亮点

- Electron 桌面端支持屏幕共享、系统音频捕获、窗口置顶等原生能力
- WebSocket 实现双向音频流传输和实时语音转文字
- 基于 SSE（Server-Sent Events）的流式 AI 建议展示
- 响应式设计适配不同屏幕尺寸
- 国际化（i18n）支持中英文切换
- 模块化组件设计，便于维护和扩展

## 二、技术架构

### 2.1 整体架构

```
OfferHub/
├── offerHub_frontend_v2/    # Electron + Vue 桌面端
├── offerhub_web/           # Vue Web 端
├── 后端服务/               # Node.js/Python 后端（不在本仓库）
└── 部署文档/
```

### 2.2 前端技术栈

#### 2.2.1 共同技术栈

- **框架**：Vue 3（Composition API）
- **构建工具**：Vite 4.x
- **UI 库**：Element Plus
- **路由**：Vue Router 4
- **状态管理**：Pinia
- **国际化**：Vue I18n
- **HTTP 客户端**：Axios
- **样式预处理**：SCSS

#### 2.2.2 Electron 桌面端（V2）特有

- **桌面框架**：Electron 29
- **进程通信**：IPC（contextBridge 安全暴露）
- **原生能力**：屏幕捕获、音频设备管理、窗口控制
- **打包工具**：electron-builder
- **模式**：Hash 路由（适配 Electron）

#### 2.2.3 Web 端特有

- **部署方式**：静态文件 + Nginx 反向代理
- **路由模式**：History 模式（支持 SEO）
- **限制**：不支持屏幕共享、系统音频等桌面端特有功能

### 2.3 后端技术栈（参考）

- **服务端**：Node.js（Express）或 Python（FastAPI）
- **数据库**：MySQL + Redis
- **AI 服务**：OpenAI GPT / Claude API
- **文件存储**：AWS S3 / 阿里云 OSS
- **支付集成**：Stripe / PayPal / 微信支付 / 支付宝
- **实时通信**：WebSocket（音频流）

## 三、项目结构详解

### 3.1 Electron 桌面端（offerHub_frontend_v2）

```
offerHub_frontend_v2/
├── electron/               # Electron 主进程相关
│   ├── main.js            # 主进程入口，窗口管理
│   └── preload.js         # 预加载脚本，API 暴露
├── src/
│   ├── main.js            # Vue 应用入口
│   ├── App.vue            # 根组件
│   ├── router/            # 路由配置
│   │   ├── index.js       # 主路由，语言检测
│   │   └── option.js      # 功能模块路由
│   ├── i18n/              # 国际化配置
│   │   └── index.js       # 语言包加载
│   ├── services/          # API 服务层
│   │   ├── apiClient.js   # HTTP 客户端封装
│   │   ├── interviewApi.js # 面试相关接口
│   │   ├── interviewWebSocket.js # WebSocket 管理
│   │   ├── summaryApi.js  # 总结接口
│   │   ├── billingApi.js  # 计费接口
│   │   ├── knowledgeApi.js # 知识库接口
│   │   ├── wrongBookApi.js # 错题本接口
│   │   ├── profileApi.js  # 用户资料接口
│   │   └── cacheService.js # 缓存服务
│   └── components/        # 组件库
│       ├── interview/     # 面试相关组件
│       ├── summary/       # 总结分析组件
│       ├── wrongBook/     # 错题本组件
│       ├── knowledge/     # 知识库组件
│       ├── billing/       # 计费组件
│       ├── login/         # 登录组件
│       ├── option/        # 设置组件
│       ├── homepage/      # 首页组件
│       └── homeNested/    # 嵌套页面组件
├── public/                # 静态资源
├── dist/                  # 构建输出
├── OfferHubElectron/      # Electron 打包输出
├── vite.config.js         # Vite 配置
├── package.json           # 项目配置
└── README.md              # 项目说明
```

### 3.2 Web 端（offerhub_web）

```
offerhub_web/
├── src/
│   ├── main.js           # Vue 应用入口
│   ├── App.vue           # 根组件
│   ├── router/           # 路由配置
│   │   └── index.js      # Web 端路由
│   ├── i18n/             # 国际化
│   │   └── index.js      # 语言配置
│   ├── components/       # 页面组件
│   │   └── views/        # 视图页面
│   │       ├── Home.vue  # 首页
│   │       ├── HelpCenter.vue # 帮助中心
│   │       ├── Contact.vue # 联系我们
│   │       └── Download.vue # 下载页
│   ├── config/           # 配置文件
│   │   └── app.js        # 应用配置
│   └── styles/           # 全局样式
├── public/               # 静态资源
├── dist/                 # 构建输出
├── OfferHubWeb/          # Web 构建产物
├── vite.config.js        # Vite 配置
├── package.json          # 项目配置
└── 部署流程.md           # 部署说明
```

## 四、核心功能实现

### 4.1 路由与权限管理

#### 4.1.1 路由配置

- **Electron 端**：使用 Hash 模式，避免 Electron 中的路径问题
- **Web 端**：使用 History 模式，提供更友好的 URL
- **语言路由**：支持 `/zh-CN/` 和 `/en-US/` 前缀
- **路由守卫**：自动同步语言设置，验证登录状态

#### 4.1.2 权限控制

- 基于 Token 的身份验证
- 路由级权限控制（登录页、功能页）
- API 请求自动携带 Token
- Token 过期自动跳转登录

### 4.2 国际化（i18n）

- 使用 Vue I18n 实现多语言
- 支持中文（zh-CN）和英文（en-US）
- 语言状态与路由同步
- 组件内使用 `$t()` 方法翻译
- 动态语言切换无需刷新

### 4.3 API 服务架构

#### 4.3.1 HTTP 客户端封装

- 基于 Axios 创建统一客户端
- 自动设置 baseURL（环境区分）
- 请求拦截器添加 Token
- 响应拦截器统一错误处理
- 支持文件上传下载

#### 4.3.2 API 模块划分

- **interviewApi**：面试相关接口
  - 获取面试配置
  - 开始/结束面试
  - 获取面试历史
  - 发送额外问题
  - 流式获取 AI 建议（SSE）
  
- **billingApi**：计费相关接口
  - 获取套餐列表
  - 创建订单
  - 支付确认
  - 使用记录查询
  
- **knowledgeApi**：知识库接口
  - 获取题库列表
  - 搜索题目
  - 获取参考答案
  
- **wrongBookApi**：错题本接口
  - 添加错题
  - 获取错题列表
  - 更新错题状态
  - 导出错题
  
- **profileApi**：用户资料接口
  - 获取用户信息
  - 更新资料
  - 修改密码
  
- **summaryApi**：总结接口
  - 获取面试总结
  - 能力分析数据
  - 删除记录

### 4.4 WebSocket 实时通信

#### 4.4.1 连接管理

- 使用原生 WebSocket API
- 支持双向音频流传输
- 自动重连机制
- 连接状态管理

#### 4.4.2 音频处理

- 支持 PCM 和 Blob 格式
- 背压控制防止内存溢出
- 实时语音转文字（STT）
- 音频数据分片传输

### 4.5 Electron 特有功能

#### 4.5.1 窗口管理

- 主窗口：最大化、最小化、关闭
- 浮动窗口：AI 建议实时显示
- 窗口置顶功能
- 内容保护模式（防截图）

#### 4.5.2 系统集成

- 屏幕录制与截图
- 系统音频捕获
- 音频设备枚举
- 文件系统访问
- 系统通知

#### 4.5.3 IPC 通信

通过 contextBridge 安全暴露以下 API：
- 窗口控制：最小化、最大化、关闭
- 屏幕操作：获取屏幕源、开始/停止录制
- 音频管理：获取设备列表、请求权限
- 浮动窗口：创建、显示、隐藏、更新内容
- 内容保护：开启/关闭防截图
- PDF 查看：打开 PDF 文件
- 外部链接：打开浏览器

## 五、业务流程详解

### 5.1 用户登录流程

1. 用户打开应用，检查本地 Token
2. 若无 Token 或已过期，跳转登录页
3. 输入账号密码，调用登录接口
4. 保存 Token 和用户信息
5. 跳转到主页面

### 5.2 面试流程

#### 5.2.1 准备阶段

1. 选择面试类型（普通/压力/行为/技术/综合）
2. 配置面试参数（时长、难度等）
3. 检查音频设备权限
4. 进入面试房间

#### 5.2.2 面试进行

1. 系统播放面试问题
2. 用户语音回答，实时转文字
3. AI 分析回答，生成建议
4. 浮动窗口显示实时建议
5. 支持暂停、继续、结束面试

#### 5.2.3 面试结束

1. 生成面试总结报告
2. 展示能力分析图表
3. 提供改进建议
4. 保存到历史记录
5. 可添加错题到错题本

### 5.3 计费流程

1. 查看可用时长
2. 选择充值套餐
3. 创建支付订单
4. 跳转支付页面
5. 支付成功后更新余额
6. 发送到账通知

### 5.4 错题本管理

1. 面试中标记错题
2. 自动分类（技术/行为/综合等）
3. 添加个人笔记
4. 支持筛选和搜索
5. 导出为 PDF/Excel

## 六、部署方案

### 6.1 开发环境

#### 6.1.1 桌面端开发

```bash
# 安装依赖
npm install

# 开发模式运行
npm run electron:dev

# 构建应用
npm run electron:build

# 打包分发
npm run electron:dist
```

#### 6.1.2 Web 端开发

```bash
# 安装依赖
npm install

# 开发服务器
npm run dev

# 构建生产版本
npm run build

# 预览构建结果
npm run preview
```

### 6.2 生产环境部署

#### 6.2.1 服务器配置

- **服务器 IP**：43.140.218.98
- **操作系统**：Ubuntu 20.04+
- **Web 服务器**：Nginx
- **访问地址**：
  - Web 端：http://43.140.218.98:8088
  - Web 应用：http://43.140.218.98:8088/app

#### 6.2.2 部署步骤

1. **打包应用**
   - 桌面端：构建生成 OfferHubElectron/
   - Web 端：构建生成 OfferHubWeb/

2. **上传文件**
   ```bash
   # SSH 连接服务器
   ssh lvjinpeng@43.140.218.98
   
   # 上传文件到指定目录
   # 桌面端：/home/lvjinpeng/OfferHubElectron/
   # Web 端：/home/lvjinpeng/OfferHubWeb/
   ```

3. **设置权限**
   ```bash
   chmod -R 755 OfferHubElectron/
   chmod -R 755 OfferHubWeb/
   ```

4. **配置 Nginx**
   - 反向代理 API 请求
   - 支持 WebSocket
   - 静态文件服务
   - Gzip 压缩

5. **重启服务**
   ```bash
   sudo nginx -t
   sudo systemctl reload nginx
   ```

#### 6.2.3 Nginx 配置要点

- 监听 8088 端口
- WebSocket 代理配置（/ws/*）
- API 代理配置（/api/*）
- 静态文件根目录设置
- 缓存策略配置

## 七、功能对比（Electron vs Web）

### 7.1 Electron 桌面端独有功能

- 屏幕录制与共享
- 系统音频捕获
- 窗口置顶和浮动窗口
- 内容保护模式
- 原生文件操作
- 系统通知
- 离线缓存支持

### 7.2 Web 端限制

- 无法捕获系统音频
- 无法控制浏览器窗口
- 屏幕共享需要用户授权
- 依赖浏览器兼容性
- 部分功能受限

### 7.3 共享功能

- 用户登录注册
- 面试核心流程
- AI 建议展示
- 错题本管理
- 知识库学习
- 计费系统
- 多语言支持

## 八、性能优化

### 8.1 前端优化

- **路由懒加载**：按需加载页面组件
- **组件异步加载**：大型组件动态导入
- **图片懒加载**：优化页面加载速度
- **虚拟滚动**：大列表性能优化
- **防抖节流**：优化频繁操作

### 8.2 构建优化

- **代码分割**：Vite 自动分割
- **Tree Shaking**：移除无用代码
- **资源压缩**：Gzip/Brotli
- **缓存策略**：文件名哈希

### 8.3 WebSocket 优化

- **连接池管理**：避免重复连接
- **数据压缩**：音频数据压缩
- **断线重连**：自动恢复连接
- **心跳检测**：保持连接活跃

## 九、安全考虑

### 9.1 前端安全

- XSS 防护：内容转义
- CSRF 防护：Token 验证
- 敏感信息保护：不存储明文密码
- Electron 安全：禁用 Node 集成，启用上下文隔离

### 9.2 通信安全

- HTTPS/WSS 加密传输
- Token 过期机制
- API 权限验证
- 文件上传校验

## 十、扩展性设计

### 10.1 模块化架构

- 组件可复用设计
- API 服务独立封装
- 路由模块化管理
- 多语言可扩展

### 10.2 配置化管理

- 环境变量配置
- API 地址可配置
- 功能开关控制
- 主题样式定制

### 10.3 插件机制预留

- 面试类型可扩展
- AI 模型可切换
- 支付方式可配置
- 存储方式可选

## 十一、维护与监控

### 11.1 日志系统

- 错误日志收集
- 用户行为记录
- 性能指标监控
- API 调用统计

### 11.2 版本管理

- 语义化版本号
- 自动更新机制（Electron）
- 灰度发布支持
- 回滚方案

### 11.3 数据备份

- 用户数据定期备份
- 配置文件版本控制
- 日志文件归档
- 灾难恢复预案

## 十二、常见问题与解决方案

### 12.1 Electron 常见问题

- **白屏问题**：检查 CSP 配置和资源加载
- **权限问题**：确保正确请求系统权限
- **内存泄漏**：及时清理事件监听和定时器
- **打包体积**：使用 asar 优化和依赖检查

### 12.2 Web 端常见问题

- **路由刷新 404**：配置 Nginx fallback
- **WebSocket 连接失败**：检查代理配置
- **跨域问题**：配置 CORS 和代理
- **缓存问题**：设置合适的缓存策略

### 12.3 性能问题

- **首屏加载慢**：优化资源加载顺序
- **内存占用高**：检查组件销毁和清理
- **CPU 占用高**：优化定时器和动画
- **网络请求慢**：使用 CDN 和缓存

## 十三、未来规划

### 13.1 功能增强

- 支持更多面试场景
- 增强 AI 分析能力
- 优化用户体验
- 扩展知识库内容

### 13.2 技术升级

- 升级到最新 Vue 版本
- 引入 TypeScript
- 微前端架构改造
- 移动端适配

### 13.3 生态建设

- 开放 API 平台
- 第三方插件支持
- 社区题库共享
- 企业版功能

## 十四、总结

OfferHub 项目通过 Electron 桌面端和 Web 端的双端架构，为用户提供了灵活的面试辅助解决方案。项目采用现代化的技术栈，具有良好的可维护性和扩展性。通过模块化设计和组件化开发，确保了代码质量和开发效率。未来将继续优化用户体验，增强 AI 能力，打造更专业的求职面试平台。
